<pre> ```mermaid flowchart TD A["Start processing PDF page"] --> B["Get invoice data using Azure Document Intelligence"] B --> C["Look for important fields on the page:\nInvoice ID, Vendor Name, Total Amount, etc."] C --> D{"Does this page have Invoice ID?"} D -- Yes --> E["Remember this Invoice ID"] E --> F{"Is it different from the previous one?"} F -- Yes --> G["New Invoice Detected\n→ Return 'InvoiceIdChanged'"] F -- No --> H["Same invoice continues\n→ Keep current ID"] D -- No --> I{"Does this page have Vendor Name?"} I -- Yes --> J["Remember Vendor Name"] J --> K{"Is it different from previous page?"} K -- Yes --> L["New Vendor Detected\n→ Return 'VendorNameChanged'"] K -- No --> M["Same vendor continues"] I -- No --> N{"Does the page have Total Amount with good confidence?"} N -- Yes --> O["This is likely the end of an invoice\n→ Return 'InvoiceTotal'"] N -- No --> P{"Does it have Customer Name?"} P -- Yes --> Q["This is likely the start of an invoice\n→ Return 'InvoiceId'"] P -- No --> R["No key fields found\n→ Likely a middle page\n→ Return 'child page'"] G --> Z["Done"] L --> Z O --> Z Q --> Z R --> Z M --> Z H --> Z ``` </pre>
